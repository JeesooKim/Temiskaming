@{
    Layout = null;
    }

@Ajax.ActionLink("Exit Chat", "Exit", "Chat", new AjaxOptions
{
    HttpMethod = "Post",
    InsertionMode = InsertionMode.Replace,
    UpdateTargetId = "chat"
})

    <p id="chatLog">

    </p>
    <div id="chatUrl">@Url.Content("~/chatLogs/test.txt")</div>


@Html.Partial("Send")

<script type="text/javascript" >
    function loadChatLog() {
        var oldHeight = $("#chatLog").prop('scrollHeight') - 20;
        var chaturl = $("#chatUrl").html();
        $.ajax({
            url: chaturl,
            cache: false,
            success: function (html) {
                $("#chatLog").html(html);
                var newHeight = $("#chatLog").prop('scrollHeight') - 20;
                if (newHeight > oldHeight) {
                    $("#chatLog").animate({ scrollTop: newHeight }, 'normal');
                }
            }
        })

    }
    loadChatLog();
    var sHeight = $("#chatLog").prop('scrollHeight');
    $("#chatLog").animate({ scrollTop: sHeight }, 'normal');



    setInterval(loadChatLog, 500);
</script>